# Шпаргалка архитектора

## Расскажите о принципах SOLID.

**SOLID** - принципы объектно ориентированного дизайна, сформулированные Робертом Мартином

> Design principles encourage us to create more maintainable, understandable, and flexible software

- **Single Responsibility** (принцип единой ответственности)
    
  Каждый класс/метод должем иметь свою задачу (ответственность), причем только одну.

  Например, не стоит смешивать вычисления и вывод данных в одном классе, разнеси их.


- **Open/Closed** (принцип открытости/закрытости)
  
  Открыт для расширения, закрыт для изменения

  Например. Имея в классе уепочку фильтров не стоит заставлять другого разработчика для добавления нового фильтра 
  лезть внутрь класса и добавлять новый ```if``` на 137 строке, дай ему интерфейс для этого

  
- **Liskov Substitution** (принцип подстановки Лисков)

  > В том случае, если q(x) — свойство, верное по отношению к объектам х некого типа T, 
  > то свойство q(y) тоже будет верным относительно ряда объектов y, 
  > которые относятся к типу S, при этом S — подтип некого типа T

  Следование принципу LSP заключается в том, что при построении иерархий наследования, 
  создаваемые наследники должны корректно реализовывать поведение базового типа. 
  То есть если базовый тип реализует определённое поведение, 
  то это поведение должно быть корректно реализовано и для всех его наследников.

  
- **Interface Segregation** (принцип разделения интерфейса)

  Следование принципу ISP заключается в создании интерфейсов, 
  которые достаточно специфичны и требуют только необходимый минимум реализаций методов. 
  Избыточные интерфейсы, напротив, могут требовать от реализующего класса создание большого количества методов, 
  причём даже таких, которые не имеют смысла в контексте класса.
https://refactoring.guru/ru/design-patterns/catalog
  Не раздувай интерфейсы.

  
- **Dependency Inversion** (принцип инверсии зависимостей)

  Модули верхних уровней не должны зависеть от модулей нижних уровней, 
  а оба типа модулей должны зависеть от абстракций; сами абстракции не должны зависеть от деталей, 
  а вот детали должны зависеть от абстракций.

  Например. Когда класс, содержащий бизнес логику, запрашивает данные из БД, 
  этот класс не должен содержать реализации механизма взаимодействия с БД, а должен вызывать соответствующий интерфейс.
  

## Расскажите о шаблонах GRASP

**GRASP** (General Responsibility Assignment Software Patterns) — шаблоны проектирования, 
используемые для решения общих задач по назначению обязанностей классам и объектам.
Не имеют выраженной структуры, четкой области применения и конкретной решаемой проблемы, 
а лишь представляют собой обобщенные подходы, рекомендации, принципы, используемые при проектировании дизайна системы.

Основные шаблоны:
- Information Expert (Информационные эксперты)
- Creator (Создатель)
- Controller (Контроллер)
- Low Coupling (Слабая связанность)
- High Cohesion (Высокая сцепленность)
- Pure Fabrication (Чистая выдумка)
- Indirection (Посредник)
- Protected Variations (Сокрытие реализации или защищенные изменения)
- Polymorphism (Полиморфизм)

## Расскажите о шаблонах GoF

**Design Patterns: Elements of Reusable Object-Oriented Software** - книга 1994, 
описывающая шаблоны(паттерны) проектирования програмного обеспечения, 
авторов которой прозвали "Бандой четырех(Gang of Four)"

**Шаблон(паттерн) проектирования** — решение типовой задачи проектирования.

## Что такое поведенческие шаблоны?

Эти паттерны решают задачи эффективного и безопасного взаимодействия между объектами программы.

Включают в себя:
- Chain of responsibility (Цепочка обязанностей)
- Command (Команда)
- Iterator (Итератор)
- Mediator (Посредник)
- Memento (Снимок)
- Observer (Наблюдатель)
- State (Состояние)
- Strategy (Стратегия)
- Template method (Шаблонный метод)
- Visitor (Посетитель)

## Что такое порождающие шаблоны?

Эти паттерны отвечают за удобное и безопасное создание новых объектов или даже целых семейств объектов.

Включают в себя:
- Factory method (Фабричный метод)
- Abstract factory (Абстрактная фабрика)
- Builder (Строитель)
- Prototype (Прототип)
- Singleton (Одиночка)

## Что такое структурные шаблоны?

Эти паттерны отвечают за построение удобных в поддержке иерархий классов.

Включают в себя:
- Adapter (Адаптер)
- Bridge (Мост)
- Composite (Компоновщик)
- Decorator (Декоратор)
- Facade (Фасад)
- Flyweight (Легковес)
- Proxy (Заместитель)

## Расскажите о паттерне Singleton

Цель - создать клас с единственным экземпляром и предоставить к нему единую точку доступа

```java
//Однопоточная реализация
public final class Singleton {
    
private static Singleton instance;

    private Singleton() {}

    public static Singleton getInstance(String value) {
        if (instance == null) {
            instance = new Singleton(value);
        }
        return instance;
    }
}
```

## Расскажите о паттернах Фабричный метод и абстрактная фабрика

Фабричный метод — статичный метод инициализирующий объект класса.

Абстрактная фабрика — класс порождающий инстансы объектов других классов.

## Расскажите о паттернe адаптер 

Адаптер — это структурный паттерн проектирования, 
который позволяет объектам с несовместимыми интерфейсами работать вместе.

## Расскажите о паттернe мост

Мост — это структурный паттерн проектирования, 
который разделяет один или несколько классов на две отдельные иерархии — абстракцию и реализацию, п
озволяя изменять их независимо друг от друга.

## Расскажите о паттерне Proxy

**Proxy(Заместитель)** — это структурный паттерн проектирования, 
который позволяет подставлять вместо реальных объектов специальные объекты-заменители. 
Эти объекты перехватывают вызовы к оригинальному объекту, 
позволяя сделать что-то до или после передачи вызова оригиналу.

## Расскажите о паттерне Декоратор

Декоратор — это структурный паттерн проектирования, 
который позволяет динамически добавлять объектам новую функциональность, оборачивая их в полезные «обёртки».

## Расскажите о паттерне Шаблонный метод

Шаблонный метод — это поведенческий паттерн проектирования, 
который определяет скелет алгоритма, перекладывая ответственность за некоторые его шаги на подклассы. 
Паттерн позволяет подклассам переопределять шаги алгоритма, не меняя его общей структуры.

## Расскажите о паттерне Фасад

Фасад — это структурный паттерн проектирования, 
который предоставляет простой интерфейс к сложной системе классов, библиотеке или фреймворку.

Фасад — это простой интерфейс для работы со сложной подсистемой, содержащей множество классов. 
Фасад может иметь урезанный интерфейс, не имеющий 100% функциональности, 
которой можно достичь, используя сложную подсистему напрямую. 
Но он предоставляет именно те фичи, которые нужны клиенту, и скрывает все остальные.

## Что такое рефакторинг? Объясните понятие "чистого" кода

Рефакторинг — изменение структуры кода без изменения его функциональности.

Проводится для облегчения понимания и дальнейшей модификации кода.

Чистый код — код, который лего понимать и поддерживать. 


## Что такое UML?
**UML** – унифицированный язык моделирования (Unified Modeling Language) – это система обозначений, 
которую можно применять для объектно-ориентированного анализа и проектирования. 
Его можно использовать для визуализации, спецификации, конструирования и документирования программных систем.

## Что такое class diagram?

Диаграмма описывающая классы, их поля, методы и взаимоотношения между классами

Пример:

![UML class-diagram](img/uml/UML_class_diagram_hotel-949x683.png?raw=true)

## Что такое sequence diagram?

Диаграммы последовательностей показывают, как и в какой последовательности объекты взаимодействуют между собой. 
Взаимодействие иллюстрирует определенный сценарий.

![UML sequence-diagram](img/uml/sequence_diagram_atm_example-800x1292.png?raw=true)

## Что такое use-case diagram?

Описывает сценарии взаимодействия пользователей с системой

![UML use-case](img/uml/UML_use_case_example1-750x731.png?raw=true)

## Что такое ER-diagram?

## Что такое Data Flow диаграмма?

## Что такое BPMN?

## Что такое IDEF?



## Расскажите о паттерне Inversion of Control (IoC) и его реализациях

## Что такое Model-view-controller (MVC)?

## Что такое Data access object (DAO)?

Паттерн предназначен для инкапсуляции логики доступа к персистентному хранилищу.

Представляет из себя контроллер доступа к хранилищу.

Пример:

Сначала создается абстракный контроллер содержащий методы для работы с сущностями и хранилищем и класс сущности
```java
public abstract class AbstractController <E, K> { 
    //E - класс сущности 
    //К - класс первичного ключа сущности
    
    //пример методов для работы с сущностями
    public abstract List<E> getAll();
    public abstract E getEntityById(K id);
    public abstract E update(E entity);
    public abstract boolean delete(K id);
    public abstract boolean create(E entity);
    
    //пример методов для работы с хранилищем 
    public PreparedStatement getPrepareStatement(String sql) {...}
    public void closePrepareStatement(String sql) {...}
}
```
```java
public class User {
    private Integer id;
    private String name;
    //Constructor, getters, setters...
}
```

Далее от абстрактного контроллера наследуется контроллер конкретной сущности
```java
public class UserController extends AbstractController<User, Integer> {
  //Имплементации абстрактных методов
  public List<User> getAll() {...}
  public User getEntityById(Integer id) {...}
  public User update(User entity) {...}
  public boolean delete(Integer id) {...}
  public boolean create(User  entity) {...}
}
```

Этот контроллер уже будет использоваться в бизнес логике для работы с объектами

## Что такое Layered architecture?

Система делится на уровни, каждый из которых взаимодействует только с соседями.
Таким образом взаимодействие элементов становится прямолинейным, каждый уровень получает запрос от 
верхнего уровня, обрабатывает и передает на уровень ниже.

![UML sequence-diagram](img/architecture/layered-architecture.png?raw=true)

## Типовая структура Enterprise приложения. Слои, зоны ответственности и зависимости между слоями.

Типичное enterprise приложение представляет собой трехслойную архитектуру (смотри рисунок из предыдущего вопроса).
Состоит из:
- слоя представления (отвечает за взаимодействие с пользователем и отображение данных)
- слоя бизнес-логики (полезная нагрузка)
- слоя данных (отвечает за взаимодействие с персистентными данными)

<!--- Нужно ли дополнить про зависимости? --->

## Какие вы знаете способы интеграции программного обеспечения?

> Интегра́ция (от лат. integratio — «соединение») — процесс объединения частей в целое. 

**Интеграция программных систем и продуктов** — это обмен данными между системами с возможной последующей их обработкой.

**Цель интеграции** — автоматический перенос данных между системами

Способы:
- Обмен файлами
- Общая БД
- Удаленный вызов процедур
- Обмен сообщениями

## Типы интеграции (общий ресурс, удаленный вызов процедур, обмен сообщениями), сравнение.

## Расскажите о системах обмена сообщениями




## Что такое высоконагруженные приложения?

Термин не имеет четкого определения.

Четкой границы между высокой нагрузкой и невысокой нагрузкой тоже нет.

Высоконагруженным приложение становится при появлении или ожидании высокой нагрузки ~~(неожиданно)~~.
Это может быть связано с большим количеством запросов, большим объемом обрабатываемых данных или сложностью вычислений.

Однозначно сказать что твоё приложение высоконагружено можно, когда появились проблемы с таймаутами ответов, 
слишком долго выполняющимися запросами в бд, зашкаливающим использованием ресурсов и так далее.

Но лучше к этому готовиться заранее и подходить к разработке 
приложений и сервисов с учетом возможной возрастающей нагрузки.

## Какие проблемы бывают в высоконагруженных приложениях?

## Что такое репликация?


**Репликация** — это процесс, под которым понимается копирование данных из одного источника на другой 
(или на множество других) и наоборот.

При репликации изменения, сделанные в одной копии объекта, могут быть распространены в другие копии.


## Что такое шардирование?

**Шардирование** (горизонтальное партиционирование) — это принцип проектирования базы данных, 
при котором логически независимые строки таблицы базы данных хранятся раздельно, 
заранее сгруппированные в секции, которые, в свою очередь, размещаются на разных, 
физически и логически независимых серверах базы данных, при этом один физический узел кластера 
может содержать несколько серверов баз данных.

Шардирование обычно используется в следующих случаях:
- Ожидаются высокая частота запросов к базе данных и быстрый рост количества данных.
- Приложение требует все больше и больше ресурсов, но решение, использующее кластер с репликацией, больше не может быть отмасштабировано с использованием вертикальной стратегии (путем наращивания вычислительной мощности хостов кластера: дисков, памяти и процессоров).


## Что такое кеширование?

**Кэширование** – это способ оптимизации работы приложения, при котором повторно запрашиваемый контент сохраняется и 
используется для обслуживания последующих запросов.

## Что такое балансировка?

**Балансировка нагрузки** — метод распределения заданий между несколькими сетевыми устройствами (например, серверами) 
с целью оптимизации использования ресурсов, сокращения времени обслуживания запросов, 
горизонтального масштабирования кластера (динамическое добавление/удаление устройств), 
а также обеспечения отказоустойчивости (резервирования).

## Какие виды балансировки Вы знаете?

Процедура балансировки осуществляется при помощи целого комплекса алгоритмов и методов, 
соответствующим следующим уровням модели OSI:

- Сетевому
  - DNS-балансировка. На одно доменное имя выделяется несколько IP-адресов
  - Построение NLB-кластера. При использовании этого способа серверы объединяются в кластер, 
    состоящий из входных и вычислительных узлов
  - Балансировка по IP с использованием дополнительного маршрутизатора
  - Балансировка по территориальному признаку осуществляется путём размещения одинаковых 
    сервисов с одинаковыми адресами в территориально различных регионах
- Транспортному
  - клиент обращается к балансировщику, тот перенаправляет запрос одному из серверов, который и будет его обрабатывать
- Прикладному
  - При балансировке на прикладном уровне балансировщик работает в режиме «умного прокси». 
    Он анализирует клиентские запросы и перенаправляет их на разные серверы в зависимости 
    от характера запрашиваемого контента. Так работает, например, веб-сервер Nginx

## Что такое отказоустойчивость? Как ее можно обеспечить?

Отказоустойчивость — способность системы сохранять работоспособность при отказе одного или нескольких компонентов.

Отказоустойчивость можно реализовать двумя способами:

1) Использование только отказоустойчивых компонентов.
1) Создание компонентов, которые могут продолжить работу при отказе нескольких компонентов, от которых они зависят.

Избыточность — это наличие в структуре устройства возможностей сверх тех, 
которые могли бы обеспечить его нормальное функционирование.

- **Аппаратная избыточность** - дублирование на уровне железа. Например, дублирование записи информации на нескольких жестких дисках (RAID массив), 
  благодаря этому информация не будет потеряна при выходе из строя одного жесткого диска.

- **Программная избыточность** - закладывание в код возможности обработки ошибок при отказе некоторых компонентов. 
  Например, отправка повторных запросов, автоматический переход на копии бд
  
- **Информационная избыточность** - дублирование передаваемой информации в канале передачи. 
  Объем передаваемой информации больше чем ее изначальный объем, 
  за счет этого потеря части информации не помешает ее восприятию.
  
- **Временная избыточность** - сложный вычислительный процесс может быть перезапущен в случае ошибки 
  или выполнен несколько раз для сравнения результата. 
  Актуально для вычислений с недетерминированным (не предопределенным результатом), например, нейросетей.

## Что такое мониторинг и алертинг?

**Мониторинг** — это автоматизированная система контроля состояния элементов.

Мониторинг позволяет вести отслеживание состояния системы и ее компонентов и наглядно их отображать.
Например, позволяет видеть аппаратную загрузку серверов, количество обрабатываемых системой запросов или возникающих ошибок

**Алертинг** — создание оповещений по условным триггерам мониторинга. 
Служит для оповещения заинтересованных лиц и предотвращения возможных проблем в системе

Это может быть рассылка писем, сообщений и других оповещений при привышении загрузки CPU на каком-то из серверов, 
при превышении определенного порога ошибок или исчерпании табличного пространства в БД.

## Что такое микросервисы?

**Микросервис** - небольшой, слабо связанный, легко изменяемый модуль системы, 
содержащий в себе бизнес логику и данные для решения своих задач.

## Когда нужны микросервисы, а когда монолиты?

## Что такое DDD?

**DDD** (Domain-driven design, предметно-ориентированное программирование) - это подход, 
который нацелен на изучение предметной области предприятия в целом или каких-то отдельных бизнес-процессов. 
Это отличный подход для проектов, в которых сложность (запутанность) бизнес-логики достаточно велика.
Его применение призвано снизить эту сложность, насколько возможно. 

Сначала структурируй бизнесс-процессы, только потом код.

## Каковы преимущества микросервисной архитектуры?

- **Высокая отказоустойчивость**: при падении одного из сервисов, все остальные остаются в строю
- **Гибкость**: можно попробовать внедрить новую технологию малой кровью. 
  Это будет значительно быстрее и, при неудаче, откатить изменения просто.
- **Простота**: каждый сервис по отдельности мал и легко поддается изменениям
- **Масштабируемость**: при грамотной организации балансировки, в случае нехватки ресурсов, 
  кластер можно легко горизонтально масштабируется. Причем можно масштабировать отдельные модули.

## Каковы недостатки микросервисной архитектуры?

- **Расходы на обмен сообщениями и форматирование данных**. 
  В микросервисной архитектуре данные многократно 
  преобразуются между форматами (например, преобразование объекта в json), 
  делаются многократные запросы в различные бд и на все это тратятся ресурсы и время.
- **Растущая сложность взаимодействий между сервисами**. 
  Вся система может рухнуть из-за несогласованности в API отдельных сервисов.
- **Данные больше не хранятся в одном месте**. У каждого микросервиса своя бд с изолированными данными. 
  И при необходимости их агрегировать придется собирать данные из нескольких источников
- **Сложность тестирования**. Сначала нужно отдельно разбираться с каждым сервисом, 
  а потом тестировать корректное взаимодействие его с другими микросервисами.
- **Усложнение мониторинга**.  

## Расскажите о принципы организации микросервисов



## Расскажите о типах взаимодействий микрсоервисов

## Что такое асинхронное взаимодействие?

**Синхронное взаимодействие** — сервис отправляет запрос, останавливается и ждет ответ.
**Асинхронное взаимодействие** — сервис отправляет сообщение, которое будет обработано позднее, 
и вернется к его обработке, когда будет получе ответ.

## Что такое распределенные транзакции?

## Что такое configuration server?

**Configuration server** - сервис хранящий в себе настройки других сервисов. 
Благодаря этому появляется возможность хранить конфигурации в одном месте и 
появляется возможность обновлять конфигурации на ходу.

![configuration-server](img/architecture/configuration-server.png?raw=true)

## Что такое polyglot persistance?

**Polyglot persistance** - возможность использовать в рамках одной архитектуры 
несколько моделей СУБД (например, реляционную и нереляционную).

Этот подход позволяет пользоваться преимуществами разных подходов к хранению данных.
Хорошо вписывается в микросервисную модель, так как в каждом независимом сервисе будет использоваться 
наиболее подходящее хранилище данных 

## Что такое Service Discovery?

**Service Discovery** создан для того, чтобы с минимальными затратами можно подключить новое приложение 
в уже существующее наше окружение.

![service-descovery](img/architecture/service-discovery.png?raw=true)

## Что такое Circuit Breaker?